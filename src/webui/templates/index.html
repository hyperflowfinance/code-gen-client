{% extends "base.html" %}

{% block content %}
  <div class="text-center mb-12 fade-in">
    <h1 class="text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
      GraphQL Client UI
    </h1>
    <p class="text-xl text-gray-300">Auto-generated controls for client methods</p>
    <div class="mt-4 text-sm text-gray-400">
      Endpoint:
      <span class="font-mono text-gray-200">{{ graphql_url }}</span>
    </div>
  </div>

  <div class="mb-6 bg-gray-800/70 border border-gray-700 rounded-lg p-4 fade-in">
    <div class="text-sm text-gray-300">
      Tips: use JSON for complex inputs (objects or lists). Empty optional fields are ignored.
    </div>
  </div>

  <div class="grid gap-6 md:grid-cols-2">
    {% for op in operations %}
      <div class="bg-gray-800 rounded-lg overflow-hidden shadow-lg fade-in">
        <div class="bg-gradient-to-r from-{{ op.theme }}-600 to-{{ op.theme }}-800 p-4">
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-bold">{{ op.name }}</h2>
            <span class="bg-{{ op.theme }}-500 text-white px-2 py-1 rounded text-xs">{{ op.kind_label }}</span>
          </div>
        </div>
        <div class="p-4">
          <form
            class="space-y-3"
            hx-post="/run/{{ op.name }}"
            hx-target="#result-{{ op.name }}"
            hx-swap="innerHTML"
          >
            {% if op.params %}
              {% for param in op.params %}
                <div>
                  <label class="text-xs uppercase tracking-wide text-gray-400">
                    {{ param.name }}
                    {% if param.required %}
                      <span class="text-red-400">*</span>
                    {% endif %}
                    <span class="text-gray-500">({{ param.type_name }})</span>
                  </label>
                  {% if param.input_type == "textarea" %}
                    <textarea
                      class="w-full bg-gray-900 border border-gray-700 rounded px-3 py-2 text-sm text-gray-100 h-24"
                      name="{{ param.name }}"
                      placeholder="{{ param.placeholder }}"
                      {% if param.required %}required{% endif %}
                    ></textarea>
                  {% elif param.input_type == "checkbox" %}
                    <div class="mt-2 flex items-center gap-2">
                      <input
                        type="checkbox"
                        name="{{ param.name }}"
                        class="h-4 w-4"
                        {% if param.required %}required{% endif %}
                      />
                      <span class="text-sm text-gray-300">true</span>
                    </div>
                  {% else %}
                    <input
                      class="w-full bg-gray-900 border border-gray-700 rounded px-3 py-2 text-sm text-gray-100"
                      type="{{ param.input_type }}"
                      name="{{ param.name }}"
                      placeholder="{{ param.placeholder }}"
                      {% if param.required %}required{% endif %}
                    />
                  {% endif %}
                </div>
              {% endfor %}
            {% else %}
              <div class="text-sm text-gray-400">No parameters.</div>
            {% endif %}

            <button
              class="bg-{{ op.theme }}-500 hover:bg-{{ op.theme }}-600 text-white font-semibold px-4 py-2 rounded"
              type="submit"
            >
              Run {{ op.name }}
            </button>
          </form>
          <div id="result-{{ op.name }}"></div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock %}
